
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Genkit Hands-on</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/claat-public/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14" ga4id=""></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  codelab-ga4id="2P6VCDLG05"
                  id="ja"
                  title="Genkit Hands-on"
                  environment="web"
                  feedback-link="https://github.com/tanabee/genkit-codelab/issues">
    
      <google-codelab-step label="Intro" duration="1">
        <p>ã“ã®ãƒãƒ³ã‚ºã‚ªãƒ³ã§ã¯ Genkit ã®åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‹ã‚‰ã¯ã˜ã‚ã¦ã€ Code Execution ã‚„ Function Calling ãªã©ã®æ©Ÿèƒ½ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§å‹•ä½œã•ã›ã¾ã™ã€‚éå¸¸ã«ç°¡å˜ãªå†…å®¹ã«ãªã£ã¦ã„ã¾ã™ãŒã€ã“ã®ãƒãƒ³ã‚ºã‚ªãƒ³ã‚’é€šã—ã¦ Genkit ã‚’ç”¨ã„ãŸé–‹ç™ºãŒã„ã‹ã«åŠ¹ç‡çš„ã«è¡Œãˆã‚‹ã‹ä½“é¨“ã—ã¦ã„ãŸã ã‘ã‚‹ã¨æ€ã„ã¾ã™ã€‚</p>
<h2 is-upgraded>å‰ææ¡ä»¶</h2>
<ul>
<li>Node.js v20+</li>
<li>npm</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Get Gemini API key" duration="2">
        <p>ä»¥ä¸‹ã®ã‚µã‚¤ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€ Gemini ã® API ã‚­ãƒ¼ã‚’å–å¾—ã—ã¦ãã ã•ã„ã€‚</p>
<ul>
<li><a href="https://aistudio.google.com/app/apikey" target="_blank">Get API key | Gemini</a></li>
</ul>
<p>2025 å¹´ 11 æœˆæ™‚ç‚¹ã«ãŠã„ã¦ã€API ã‚­ãƒ¼ã«ã¯ç„¡æ–™æ ãŒå­˜åœ¨ã—ã€ãƒãƒ³ã‚ºã‚ªãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ç¯„å›²ã§ã‚ã‚Œã°èª²é‡‘ã®å¿ƒé…ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
<ul>
<li><a href="https://ai.google.dev/pricing" target="_blank">Pricing models | Gemini</a></li>
</ul>
<p>ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ä»¥ä¸‹ã® curl ã‚³ãƒãƒ³ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘ã¦ <code>YOUR_API_KEY</code> éƒ¨åˆ†ã‚’ç½®ãæ›ãˆã¦å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚æ­£å¸¸ã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¿”ã£ã¦ãã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚</p>
<pre><code language="language-sh" class="language-sh">curl &#34;https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent&#34; \
-H &#39;Content-Type: application/json&#39; \
-H &#39;X-goog-api-key: YOUR_API_KEY&#39; \
-X POST \
-d &#39;{
  &#34;contents&#34;: [
    {
      &#34;parts&#34;: [
        {
          &#34;text&#34;: &#34;Firebase ã«ã¤ã„ã¦ 200 æ–‡å­—ä»¥å†…ã§èª¬æ˜ã—ã¦ãã ã•ã„ã€‚&#34;
        }
      ]
    }
  ]
}&#39;
</code></pre>
<p>Windows ã®å ´åˆã¯ PowerShell ä¸Šã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚</p>
<pre><code language="language-PowerShell" class="language-PowerShell">(curl `
  -Headers @{&#34;Content-Type&#34;=&#34;application/json&#34;} `
  -Body &#39;{&#34;contents&#34;:[{&#34;parts&#34;:[{&#34;text&#34;:&#34;Firebase ã«ã¤ã„ã¦ 200 æ–‡å­—ä»¥å†…ã§èª¬æ˜ã—ã¦ãã ã•ã„ã€‚&#34;}]}]}&#39; `
  -Method POST `
  -Uri &#39;https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=YOUR_API_KEY&#39;).Content
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="Hello Genkit!" duration="5">
        <p>ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åˆæœŸè¨­å®šã‚’è¡Œã„ã¾ã™ã€‚</p>
<pre><code language="language-sh" class="language-sh">$ npm create genkitx

? Select template â€º - Use arrow-keys. Return to submit.
â¯   Minimal - This is a Minimal template
    MCP

? Enter your project name â€º hello-genkit

âœ… Project &#34;hello-genkit&#34; has been successfully generated

$ cd hello-genkit
</code></pre>
<p>å…ˆã»ã©å–å¾—ã—ãŸ Gemini ã® API ã‚­ãƒ¼ã‚’ç’°å¢ƒå¤‰æ•°ã«ã‚»ãƒƒãƒˆã—ã¾ã™ã€‚</p>
<pre><code language="language-sh" class="language-sh">export GEMINI_API_KEY=&lt;your-api-key&gt;
</code></pre>
<p>Windows ã®å ´åˆã¯ PowerShell ã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã€Gemini ã® API ã‚­ãƒ¼ã‚’ç’°å¢ƒå¤‰æ•°ã«ã‚»ãƒƒãƒˆã—ã¾ã™ã€‚</p>
<pre><code language="language-PowerShell" class="language-PowerShell">$env:GEMINI_API_KEY=&#34;&lt;your API key&gt;&#34;
</code></pre>
<p>ãƒ•ã‚¡ã‚¤ãƒ« <code>src/index.ts</code> ã‚’ç¢ºèªã—ã¾ã™ã€‚ã“ã®ã‚³ãƒ¼ãƒ‰ãŒ Genkit ã«ã‚ˆã‚‹ç”Ÿæˆ AI ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å®Ÿæ…‹ã¨ãªã‚‹ã‚³ãƒ¼ãƒ‰ã§ 20 è¡Œç¨‹åº¦ã§æ›¸ãã“ã¨ãŒã§ãã¾ã™ã€‚</p>
<pre><code language="language-typescript" class="language-typescript">import { genkit, z } from &#39;genkit&#39;
import { googleAI } from &#39;@genkit-ai/googleai&#39;
import { startFlowServer } from &#39;@genkit-ai/express&#39;
import { logger } from &#39;genkit/logging&#39;
logger.setLogLevel(&#39;debug&#39;)

const ai = genkit({
  plugins: [googleAI()],
  model: googleAI.model(&#39;gemini-2.5-flash-lite&#39;, {
    temperature: 0.8,
  }),
})

const mainFlow = ai.defineFlow({
  name: &#39;mainFlow&#39;,
  inputSchema: z.string(),
}, async (input) =&gt; {
  const { text } = await ai.generate(input)
  return text
})

startFlowServer({ flows: [mainFlow] })
</code></pre>
<p>ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ Genkit ãŒèµ·å‹•ã—ã€ Developer Tools ãŒè‡ªå‹•çš„ã«ç«‹ã¡ä¸ŠãŒã‚Šã¾ã™ã€‚</p>
<pre><code language="language-sh" class="language-sh">npm start
</code></pre>
<p>Flows ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ <code>mainFlow</code> ã‚’é¸æŠã—ã¾ã™ã€‚æ–‡å­—åˆ—ã‚’å…¥åŠ›ã— <code>Run</code> ãƒœã‚¿ãƒ³ã‚’é¸æŠã™ã‚‹ã¨ Gemini ã«å¯¾ã—ã¦ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’æŠ•ã’ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>
<ul>
<li>ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¾‹: <code>Firebase ã‚’ 200 æ–‡å­—ä»¥å†…ã§èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</code></li>
</ul>
<p class="image-container"><img alt="Hello Genkit! | Flow" src="img/529467bdc4739cdd.png"></p>
<p><code>View trace</code> ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ Gemini API ã«å¯¾ã™ã‚‹ Input, Output ã‚’è©³ç´°ã«ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ <img alt="Hello Genkit! | Trace" src="img/f6d9537120ac247d.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Code Execution" duration="3">
        <p>Gemini ã® Code Execution ã‚’ç”¨ã„ã‚‹ã¨ã€ Python ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆãƒ»å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´ã¯ 1 è¡Œã ã‘ã§ã™ã€‚</p>
<pre><code language="language-typescript" class="language-typescript">  model: googleAI.model(&#39;gemini-2.5-flash-lite&#39;, {
    temperature: 0.8,
+   codeExecution: true,
  }),
</code></pre>
<p>Developer Tools ã‚’é–‹ã„ã¦ <code>mainFlow</code> ã«ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’è¦ã™ã‚‹ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å…¥åŠ›ã—ã¾ã—ã‚‡ã†ã€‚ä»¥ä¸‹ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¾‹ã‚’æŒ™ã’ã¾ã™ã€‚</p>
<ul>
<li><code>10 ä¸‡å›ã‚³ã‚¤ãƒ³ã‚’æŠ•ã’ã¦ã€è¡¨ãŒå‡ºãŸå›æ•°ã®å‰²åˆã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã—ã¦ãã ã•ã„ã€‚</code></li>
<li><code>ãƒ•ã‚£ãƒœãƒŠãƒƒãƒæ•°åˆ—ã® 100 ç•ªç›®ã®æ•°ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚</code></li>
<li><code>Python ã§ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„: print('Hello World')</code></li>
</ul>
<p>çµæœã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚ <img alt="Code Execution | Flows" src="img/c18c8cdcf8845ca2.png"></p>
<p>View trace ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¦‹ã‚‹ã¨å®Ÿéš›ã«å®Ÿè¡Œã•ã‚ŒãŸ Python ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ <img alt="Code Execution | Trace" src="img/b7b62fb980364780.png"></p>
<h2 is-upgraded>ãƒãƒ£ãƒ¬ãƒ³ã‚¸</h2>
<p>ä½™è£•ã®ã‚ã‚‹æ–¹ã¯ Code Execution ãŒå¿…è¦ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è€ƒãˆã¦å®Ÿéš›ã«è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>


      </google-codelab-step>
    
      <google-codelab-step label="Function Calling" duration="5">
        <p>Function Calling ã¯ç”Ÿæˆ AI ãŒäº‹å‰ã«å®šç¾©ã•ã‚ŒãŸé–¢æ•°ã‚’å¿…è¦ã«å¿œã˜ã¦å‘¼ã³å‡ºã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¦æ±‚ã«åˆè‡´ã™ã‚‹å‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ä¾‹ãˆã°ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã™ã€‚</p>
<ul>
<li>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã« URL ã‚„ PDF ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã€ãã®ä¸­èº«ã‚’æŠ½å‡ºã™ã‚‹ã€‚</li>
<li>å¤–éƒ¨ API ã‚’å‘¼ã³å‡ºã— <ul>
<li>ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ç™»éŒ²</li>
<li>ãƒãƒ£ãƒƒãƒˆã‚µãƒ¼ãƒ“ã‚¹ã¸ã®é€šçŸ¥</li>
<li>ç¤¾å†…ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ¤œç´¢</li>
<li>Google æ¤œç´¢</li>
</ul>
</li>
</ul>
<p>ã“ã®ãƒãƒ³ã‚ºã‚ªãƒ³ã§ã¯ URL ã®ä¸­èº«ã‚’æŠ½å‡ºã™ã‚‹ãƒ„ãƒ¼ãƒ«ã‚’å®Ÿè£…ã—ã¦ Function Calling ã‚’ä½“é¨“ã—ã¦ã‚‚ã‚‰ã„ã¾ã™ã€‚HTML parser ã¨ã—ã¦ <a href="https://www.npmjs.com/package/cheerio" target="_blank">Cheerio</a> ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚</p>
<pre><code language="language-sh" class="language-sh">npm i cheerio
</code></pre>
<p>Code Execution ã¯ä¸€åº¦å‰Šé™¤ã—ã¦ãŠãã¾ã™ã€‚</p>
<pre><code language="language-typescript" class="language-typescript">  model: googleAI.model(&#39;gemini-2.5-flash-lite&#39;, {
    temperature: 0.8,
-   codeExecution: true,
  }),
</code></pre>
<p>cheerio ã‚’ import ã—ã¾ã™ã€‚</p>
<pre><code language="language-typescript" class="language-typescript">  import { genkit, z } from &#39;genkit&#39;
  import { googleAI, gemini25FlashPreview0417 } from &#39;@genkit-ai/googleai&#39;
+ import * as cheerio from &#39;cheerio&#39;
</code></pre>
<p>src/index.ts ã® <code>ai</code> å¤‰æ•°å®šç¾©ã®ä¸‹ã«ä»¥ä¸‹ã®é–¢æ•°ã‚’è¿½åŠ ã—ã¾ã™ã€‚ç¬¬ä¸€å¼•æ•°ã« tool ã®è¨­å®šå€¤ã‚’æŒ‡å®šã—ã€ç¬¬äºŒå¼•æ•°ã«å®Ÿè¡Œã™ã‚‹å‡¦ç†ã‚’è¨˜è¼‰ã—ã¾ã™ã€‚</p>
<pre><code language="language-typescript" class="language-typescript">const webLoader = ai.defineTool(
  {
    name: &#34;webLoader&#34;,
    description:
      &#34;When a URL is received, it accesses the URL and retrieves the content inside.&#34;,
    inputSchema: z.object({ url: z.string() }),
    outputSchema: z.string(),
  },
  async ({ url }) =&gt; {
    const res = await fetch(url)
    const html = await res.text()
    const $ = cheerio.load(html)
    $(&#34;script, style, noscript&#34;).remove()
    if ($(&#34;article&#34;)) {
      return $(&#34;article&#34;).text()
    }
    return $(&#34;body&#34;).text()
  },
)
</code></pre>
<p><code>generate</code> ãƒ¡ã‚½ãƒƒãƒ‰ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã« <code>tools</code> ã‚’æŒ‡å®šã—ã¦ã€é…åˆ—ã®ä¸­èº«ã« <code>webLoader</code> ã‚’æŒ‡å®šã—ã¾ã™ã€‚ <code>tools</code> ã¯é…åˆ—ã§æŒ‡å®šã§ãã‚‹ã®ã§è¤‡æ•°ã®ãƒ„ãƒ¼ãƒ«ã‚’è¨­å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãã®ä¸­ã‹ã‚‰å¿…è¦ãªãƒ„ãƒ¼ãƒ«ã‚’ç”Ÿæˆ AI ãŒé¸æŠã—ã¦å®Ÿè¡Œã—ã¾ã™ã€‚å¿…è¦ã‹ã©ã†ã‹ã®åˆ¤æ–­ã¯ <code>defineTool</code> ã® <code>description</code> ã‚’ã‚‚ã¨ã«è¡Œã‚ã‚Œã¾ã™ã€‚ãã®ãŸã‚ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã¨åŒæ§˜ã« <code>description</code> ã®ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã¯é‡è¦ã§ã™ã€‚</p>
<pre><code language="language-typescript" class="language-typescript">-  const { text } = await ai.generate(input)
+  const { text } = await ai.generate({ prompt: input, tools: [webLoader] })
</code></pre>
<p>æœ€çµ‚çš„ãªã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã® GitHub ã§ç¢ºèªã§ãã¾ã™ã€‚</p>
<p><a href="https://github.com/tanabee/genkit-codelab/blob/main/steps/function-calling/src/index.ts" target="_blank">https://github.com/tanabee/genkit-codelab/blob/main/steps/function-calling/src/index.ts</a></p>
<p>ãã‚Œã§ã¯ã€ã‚³ãƒ¼ãƒ‰ãŒå®Œæˆã—ãŸã®ã§ Developer Tools ã‚’é–‹ã„ã¦ã¿ã¾ã™ã€‚ Tools ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã« webLoader ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚ webLoader ã‚’é¸æŠã—ã€ä»¥ä¸‹ã® URL ã‚’æŒ¿å…¥ã—ã¦å®Ÿè¡Œã—ã¾ã™ã€‚</p>
<p>URL: <a href="https://zenn.dev/tanabee/articles/e05f722c7cbc6c" target="_blank">https://zenn.dev/tanabee/articles/e05f722c7cbc6c</a></p>
<p class="image-container"><img alt="Function Calling | Tool" src="img/e6f6a1092f44b695.png"></p>
<p>URL ã®ä¸­èº«ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’æŠ½å‡ºã§ãã¾ã—ãŸã€‚ã“ã®ã‚ˆã†ã« Genkit ã® Deleloper Tools ã§ã¯ tool å˜ä½“ã§æ¤œè¨¼ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚tool ãŒå®Ÿéš›ã«å‹•ä½œã™ã‚‹ã“ã¨ãŒåˆ†ã‹ã£ã¦ Flow ã«çµ„ã¿è¾¼ã‚€ã“ã¨ãŒã§ãã‚‹ã®ã§åŠ¹ç‡ã‚ˆãé–‹ç™ºã‚’é€²ã‚ã‚‰ã‚Œã¾ã™ã€‚</p>
<p>æ¬¡ã« Flow ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ mainFlow ã‚’é¸æŠã—ã¾ã™ã€‚ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å…¥åŠ›ã—ã¦å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚</p>
<p>ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ: <code>ä»¥ä¸‹ã® URL ã®å†…å®¹ã‚’ 200 æ–‡å­—ä»¥å†…ã§è¦ç´„ã—ã¦ãã ã•ã„ã€‚https://zenn.dev/tanabee/articles/e05f722c7cbc6c</code></p>
<p>æŠ½å‡ºã•ã‚ŒãŸå†…å®¹ã‚’ã‚‚ã¨ã«è¦ç´„ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚</p>
<p class="image-container"><img alt="Function Calling | Flow" src="img/9253f6b5ce093908.png"></p>
<p>View trace ã‚’è¦‹ã¦ã¿ã¾ã™ã€‚ã™ã‚‹ã¨ Gemini API ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒ 2 å›è¡Œã‚ã‚Œã¦ã„ã‚‹é–“ã« webLoader ã®å‘¼ã³å‡ºã—ãŒã‚ã‚Šã€å®Ÿéš›ã« tool ãŒå‘¼ã³å‡ºã•ã‚ŒãŸã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚</p>
<p class="image-container"><img alt="Function Calling | Trace" src="img/2a17c4c43a1579bf.png"></p>
<h2 is-upgraded>ãƒãƒ£ãƒ¬ãƒ³ã‚¸</h2>
<p>ä½™è£•ã®ã‚ã‚‹æ–¹ã¯è‡ªåˆ†ã§ tool ã‚’å®šç¾©ã—ã¦ Function Calling ã‚’å®Ÿè£…ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>


      </google-codelab-step>
    
      <google-codelab-step label="Model Context Protocol" duration="5">
        <p>Model Context Protocol (MCP) ã¯ã€ç”ŸæˆAIã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒå¤–éƒ¨ã®ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚„ãƒ„ãƒ¼ãƒ«ã«å®‰å…¨ã‹ã¤åŠ¹ç‡çš„ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã®æ¨™æº–åŒ–ã•ã‚ŒãŸãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã™ã€‚å…ˆã»ã©ä½“é¨“ã—ãŸ Function Calling ã¨ã®ä¸»ãªé•ã„ã¯ã€MCP ãŒ<strong>ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãƒ¬ãƒ™ãƒ«ã§ã®æ¨™æº–åŒ–</strong>ã‚’æä¾›ã™ã‚‹ç‚¹ã«ã‚ã‚Šã¾ã™ã€‚</p>
<p><strong>Function Calling</strong> ã¯ã€é–‹ç™ºè€…ãŒå€‹åˆ¥ã®ãƒ‹ãƒ¼ã‚ºã«å¯¾ã—ã¦ãƒ„ãƒ¼ãƒ«ã‚’å®šç¾©ã—ã€å‘¼ã³å‡ºã™ä»•çµ„ã¿ã§ã™ã€‚ä¸€æ–¹ã€<strong>MCP</strong> ã¯æ±ç”¨çš„ãªãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã€ç•°ãªã‚‹ AI ãƒ¢ãƒ‡ãƒ«ã‚„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–“ã§ãƒ„ãƒ¼ãƒ«ã‚„ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’å…±æœ‰ã§ãã‚‹ã‚ˆã†ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚</p>
<p><a href="https://github.com/modelcontextprotocol/servers" target="_blank">MCP ã®å…¬å¼ GitHub</a> ã«ã¯æ§˜ã€…ãªã‚µãƒ¼ãƒ“ã‚¹ã® MCP ã‚µãƒ¼ãƒãƒ¼ãŒãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—ã•ã‚Œã¦ãŠã‚Šã€ã“ã®ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ç°¡å˜ã«å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã¨æ¥ç¶šã§ãã¾ã™ã€‚</p>
<p>ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€GitHub ã® MCP ã‚µãƒ¼ãƒãƒ¼ã‚’ç”¨ã„ã¦ã€Genkit ã‹ã‚‰ GitHub ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚</p>
<p>ã“ã‚Œã¾ã§ã¨ã¯åˆ¥ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã€ <code>npm create genkitx</code> ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¯ <code>MCP</code> ã‚’é¸æŠã—ã¾ã™ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã¯ä»»æ„ã§ã™ã€‚</p>
<pre><code language="language-sh" class="language-sh">% npm create genkitx

&gt; npx
&gt; create-genkitx

? Select template â€º - Use arrow-keys. Return to submit.
    Minimal
    VertexAI
â¯   MCP - This is a MCP template
    Firebase

? Enter your project name â€º &lt;your project name&gt;
</code></pre>
<p>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆã«æˆåŠŸã™ã‚‹ã¨ä»¥ä¸‹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã®ã§ã€ã‚¬ã‚¤ãƒ‰ã®é€šã‚Šã«å®Ÿè¡Œã—ã¾ã™ã€‚</p>
<p>â€»GitHub ã® personal access token ã¯ <a href="https://github.com/settings/personal-access-tokens" target="_blank">GitHub Settings</a> ã§ä½œæˆã§ãã¾ã™ã€‚</p>
<pre><code language="language-sh" class="language-sh">âœ… Project &lt;your project name&gt; has been successfully generated

You can start your project with the following commands:
cd &lt;your project name&gt;
echo &#34;GEMINI_API_KEY=&lt;your-api-key&gt;&#34; &gt; .env
echo &#34;GITHUB_PERSONAL_ACCESS_TOKEN=&lt;your-github-personal-access-token&gt;&#34; &gt;&gt; .env
npm start
Enjoy building with Genkit! ğŸ‘
</code></pre>
<h2 is-upgraded>ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ç¢ºèª</h2>
<p><code>src/index.ts</code> ã‚’é–‹ã„ã¦ã€å‰å›ã¾ã§ã¨ã®é•ã„ã‚’ç¢ºèªã—ã¾ã™ã€‚</p>
<p>MCP ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®å®šç¾©ãŒè¿½åŠ ã•ã‚Œã¦ã„ã¾ã™ã€‚</p>
<pre><code language="language-typescript" class="language-typescript">const githubClient = createMcpClient({
  name: &#39;github&#39;,
  rawToolResponses: true,
  mcpServer: {
    command: &#39;npx&#39;,
    args: [&#39;-y&#39;, &#39;@modelcontextprotocol/server-github&#39;],
    env: process.env as Record&lt;string, string&gt;,
  },
})
</code></pre>
<p>Flowå†…ã§åˆ©ç”¨å¯èƒ½ãªMCPãƒ„ãƒ¼ãƒ«ã‚’å–å¾—ã—ã€ç”ŸæˆAIãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã«æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚</p>
<pre><code language="language-typescript" class="language-typescript">const mainFlow = ai.defineFlow({
  name: &#39;mainFlow&#39;,
  inputSchema: z.string(),
}, async (prompt) =&gt; {
  await githubClient.ready()
  const allTools = await githubClient.getActiveTools(ai)

  const enabledTools = [
    &#39;github-mcp-server/search_repositories&#39;,
    &#39;github-mcp-server/search_pull_requests&#39;,
    &#39;github-mcp-server/search_issues&#39;,
    &#39;github-mcp-server/search_code&#39;,
    &#39;github-mcp-server/list_pull_requests&#39;,
    &#39;github-mcp-server/list_issues&#39;,
    &#39;github-mcp-server/list_commits&#39;,
  ]
  const tools = allTools.filter(t =&gt; enabledTools.includes(t.__action.name))

  const { text } = await ai.generate({
    prompt,
    tools,
  })

  return text
})
</code></pre>
<p>ä»¥ä¸Šã®å¤‰æ›´ã«ã‚ˆã‚Šã€ GitHub ã«å¯¾ã—ã¦ MCP çµŒç”±ã§ãƒªãƒã‚¸ãƒˆãƒªæ¤œç´¢ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>
<h2 is-upgraded>å‹•ä½œç¢ºèª</h2>
<p><code>npm start</code> ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€Developer Tools ãŒç«‹ã¡ä¸ŠãŒã‚Šã¾ã™ã€‚ <code>Flows</code> ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ <code>mainFlow</code> ã‚’é¸æŠã—ã€ç”Ÿæˆ AI ã« <code>Tell me the top 10 GitHub repositories related to Genkit.</code> ã¨ãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ã¾ã™ã€‚</p>
<p>çµæœãŒè¿”ã£ã¦ãã¾ã—ãŸã€‚</p>
<p class="image-container"><img alt="MCP | Flows" src="img/17779ed8d9bef487.png"></p>
<p><code>View trace</code> ã‚’é¸æŠã™ã‚‹ã¨ <code>github-mcp-server/search_repositories</code> ãŒé©åˆ‡ã«åˆ©ç”¨ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚</p>
<p class="image-container"><img alt="MCP | Flows" src="img/4459a4350ab60fb0.png"></p>
<h2 is-upgraded>ã¾ã¨ã‚</h2>
<p>Function Calling ã¯é«˜ã„ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ€§ã‚’æä¾›ã™ã‚‹ä¸€æ–¹ã€MCP ã¯æ¨™æº–åŒ–ã«ã‚ˆã‚ŠæŸ”è»Ÿãªãƒ„ãƒ¼ãƒ«å…±æœ‰ã‚’å®Ÿç¾ã—ã¾ã™ã€‚ MCP ã®å†åˆ©ç”¨æ€§ã«ã‚ˆã‚Šã€æ—¢å­˜ã®ãƒ„ãƒ¼ãƒ«ã‚’ç°¡å˜ã«çµ„ã¿è¾¼ã‚ã€æ–°æ©Ÿèƒ½ã®é–‹ç™ºã«é›†ä¸­ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>
<h2 is-upgraded>ãƒãƒ£ãƒ¬ãƒ³ã‚¸</h2>
<p>ä½™è£•ã®ã‚ã‚‹æ–¹ã¯ã€ä»–ã®MCPã‚µãƒ¼ãƒãƒ¼ï¼ˆä¾‹ï¼šãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼‰ã‚’è©¦ã—ã¦ã¿ã¦ã€MCPã®æŸ”è»Ÿæ€§ã‚’ä½“é¨“ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>
<p><a href="https://github.com/modelcontextprotocol/servers" target="_blank">modelcontextprotocol/servers</a></p>


      </google-codelab-step>
    
      <google-codelab-step label="Congrats!" duration="1">
        <p>ä»¥ä¸Šã§ã“ã®ãƒãƒ³ã‚ºã‚ªãƒ³ã¯çµ‚ã‚ã‚Šã§ã™ã€‚å°‘é‡ã®ã‚³ãƒ¼ãƒ‰ã§ã“ã‚Œã ã‘ã®ã“ã¨ãŒå®Ÿç¾ã§ãã‚‹ã®ã¯ç´ æ™´ã‚‰ã—ã„ã“ã¨ã ã¨æ€ã„ã¾ã™ã€‚ã‚‚ã£ã¨æ·±å €ã‚Šã—ãŸã„æ–¹å‘ã‘ã« Next Action ã‚’æç¤ºã—ã¦ãŠãã¾ã™ã€‚</p>
<h2 is-upgraded>Next steps</h2>
<ul>
<li><a href="https://medium.com/firebase-developers/high-precision-responses-with-genkits-google-search-integration-7f142f5c9693" target="_blank">Google Search ã‚’ç”¨ã„ãŸ Grounding</a></li>
<li><a href="https://zenn.dev/cureapp/articles/e8f0dd47641bfd" target="_blank">Firebase Genkit ã‚¢ãƒ—ãƒªã‚’ Functions ã¸æ‰‹è»½ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹</a></li>
<li><a href="https://firebase.google.com/codelabs/ai-genkit-rag" target="_blank">å…¬å¼ Codelab: RAG</a></li>
<li><a href="https://zenn.dev/cureapp/articles/76bf38216ca304" target="_blank">Genkit ã‚’ä½¿ã£ã¦ Gemma2 ã‚’ãƒ­ãƒ¼ã‚«ãƒ« LLM ã¨ã—ã¦å‘¼ã³å‡ºã™</a></li>
<li><a href="https://zenn.dev/cureapp/articles/1abb1ad278bb0b" target="_blank">100 è¡Œã§ä½œã‚‹ Firebase Genkit ã® Slack ãƒœãƒƒãƒˆã‚¢ãƒ—ãƒª</a></li>
<li><a href="https://zenn.dev/yukinagae/articles/4edbd93a675077" target="_blank">Goã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ãŸã‚ã®ç”ŸæˆAI - Firebase Genkitå…¥é–€</a></li>
<li><a href="https://zenn.dev/tanabee/articles/1729f53b9a3223" target="_blank">ç¤¾å†…å‘ã‘ AI ãƒãƒ£ãƒƒãƒˆã®æ§‹ç¯‰</a></li>
</ul>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/claat-public/native-shim.js"></script>
  <script src="https://storage.googleapis.com/claat-public/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/claat-public/prettify.js"></script>
  <script src="https://storage.googleapis.com/claat-public/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>

</body>
</html>
